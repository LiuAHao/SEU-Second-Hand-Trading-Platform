# 校园二手交易平台

基于Flask架构、Python和MySQL，严格遵循实验要求的7个核心页面及业务逻辑

---

## 一、全局导航规范：通用菜单栏 (Menu Bar)

在所有页面顶部固定菜单栏以实现流畅跳转

* **左侧**：平台 Logo（SEU 二手流转）及首页链接
* **中间**：搜索框（快速搜索入口）
* **右侧**：登录状态显示
    * *未登录*：显示“登录”、“注册”按钮
    * *已登录*：显示“欢迎，[用户名]”、“购物车 (数量)”、“注销”按钮

---

## 二、7大核心页面详细设计蓝图

### 1. 首页 (Home Page)
**设计要点**：作为系统入口，需提供清晰的引导

**UI元素**：
- **欢迎横幅**：“欢迎来到 SEU 校园二手交易平台”
- **商品分类入口**：教材书籍、电子产品、生活用品、运动器材
- **热门/最新推荐**：以卡片流形式展示最近发布的商品

**后端对接**：`GET /api/items/featured` 获取首页推荐商品数据

---

### 2. 搜索页 (Search Page)
**设计要点**：支持多维度、非大小写敏感的精确与模糊检索

**UI元素**：
- **搜索表单**：一个下拉菜单（选择：标题、卖家、分类）搭配一个文本输入框
- **结果列表**：每一项显示缩略图、标题、价格、卖家名

**后端对接**：`GET /api/items/search?query=xxx&type=xxx`。后端执行SQL时使用`LOWER()`函数或`COLLATE`实现不区分大小写的匹配

---

### 3. 商品详细信息页 (Item Information Page)
**设计要点**：完整展示商品的元数据

**UI元素**：
- **基础信息**：商品标题、详细描述、价格、当前库存数量
- **卖家信息**：卖家用户名、联系方式（仅登录可见）
- **交互按钮**：“加入购物车”按钮

**后端对接**：`GET /api/items/<item_id>` 获取单体数据

---

### 4. 账号注册页 (Account Creation Page)
**设计要点**：包含严格的前端校验与唯一性检查

**UI元素**：用户名输入框、密码框（含二次确认）、邮箱/手机号

**前端校验**：检查密码长度（如 > 6 位）、邮箱格式是否为`@seu.edu.cn`

**后端对接**：`POST /api/register`。后端需返回用户名是否已存在的错误信息。注册成功后自动重定向至登录状态

---

### 5. 登录页 (Login Page)
**设计要点**：验证身份并建立持久化会话

**UI元素**：用户名、密码、验证码（可选）、“忘记密码”联系管理员链接

**后端对接**：`POST /api/login`。验证成功后，后端生成**Cookie**并在浏览器侧创建会话记录。若失败，返回原页面并显示错误提示

---

### 6. 购物车页 (Shopping Basket Page)
**设计要点**：**临时状态**存储，断开连接或刷新后清空

**实现建议**：考虑到实验要求的“非永久维护”，建议数据存储在前端的`sessionStorage`或`JavaScript 内存变量`中

**UI元素**：
- **商品列表**：显示已选商品的名称、单价、小计
- **编辑功能**：支持修改购买数量、删除特定商品

**后端对接**：无需持久化接口，但结账前需调用`GET /api/items/check_stock`批量验证当前库存是否仍充足

---

### 7. 结账页 (Checkout Page)
**设计要点**：涉及库存变更的原子操作

**前置要求**：用户必须登录且购物车有商品

**UI流程**：
1. **确认订单**：展示最终商品清单及总额
2. **支付与配送**：输入模拟信用卡信息、选择校园宿舍配送地址
3. **最终确认**：提交购买申请

**后端对接**：`POST /api/checkout`
- 后端必须开启**MySQL事务**
- 若库存（Stock）不足，操作失败并返回报错
- 若成功，对应商品的库存数量在数据库中自动扣减

---

## 三、后端逻辑规范（对接参考）

| 模块         | 数据库表设计 (MySQL)                                   | 核心业务逻辑                                                 |
| ------------ | ------------------------------------------------------ | ------------------------------------------------------------ |
| **用户模块** | `Users(uid, username, pwd_hash, email)`                | 注册时检查`username`唯一性；登录下发Cookie                   |
| **商品模块** | `Items(iid, title, price, stock, seller_id, category)` | 搜索接口支持`WHERE LOWER(title) LIKE %...%`                  |
| **订单模块** | `Orders(oid, buyer_id, total_price, status)`           | 结账时执行：`UPDATE Items SET stock = stock - ? WHERE iid = ?` |

---

